import{d as C,q as m,s as v,c as u,n as k,e as f,b as d,w as H,a as p,r as F,t as V,F as S,l as L,k as w,h as j,V as U,g as $,B as O,U as I,C as b,o as l,R,_ as q,x as E,y as N,A as T}from"./index-BF1wtGUm.js";import{B as D}from"./Breadcrumbs-CCO2WwnH.js";import{H as W,N as z}from"./Navigation-FwREv-Rv.js";import{S as A}from"./SPHeaderBar-HTze3Hzc.js";import{F as G,R as J}from"./RecordedProgram-DLd7vxXZ.js";import{V as K}from"./VSelect-rSbKDuZ_.js";import{V as X}from"./VPagination-D2ktMuVs.js";import{F as Y}from"./ForkVideos-C9pD1ikQ.js";import"./ssrBoot-Cvg94IZz.js";import"./VDialog-DxQqDTzu.js";import"./dialog-transition-BajC6ypD.js";import"./index-BFgBUmGv.js";import"./VAvatar-Bhorhnx2.js";import"./VCard-DgcsCcF8.js";import"./Videos-B97PF58P.js";import"./VTextField-MfRLvUpL.js";import"./VChip-BZHdz_ek.js";const Z={key:0,class:"recorded-program-list__header"},x={class:"recorded-program-list__title"},Q={class:"recorded-program-list__title-text"},ee={key:1,class:"recorded-program-list__title-count"},te={key:1,class:"my-2"},re={class:"recorded-program-list__empty-content"},oe=["innerHTML"],ae=["innerHTML"],se={class:"recorded-program-list__grid-content"},le={key:2,class:"recorded-program-list__pagination"},ie=C({__name:"ForkRecordedProgramList",props:{title:{},programs:{},total:{},page:{default:1},sortOrder:{default:"desc"},hideHeader:{type:Boolean,default:!1},hideSort:{type:Boolean,default:!1},hidePagination:{type:Boolean,default:!1},showMoreButton:{type:Boolean,default:!1},showBackButton:{type:Boolean,default:!1},showEmptyMessage:{type:Boolean,default:!0},emptyIcon:{default:"fluent:warning-20-regular"},emptyMessage:{default:"録画番組が見つかりませんでした。"},emptySubMessage:{default:'サーバー設定で録画フォルダのパスを<br class="d-sm-none">正しく設定できているか確認してください。'},isLoading:{type:Boolean,default:!1},isSearching:{type:Boolean,default:!1},forMylist:{type:Boolean,default:!1},forWatchedHistory:{type:Boolean,default:!1},showCustomChoice:{type:Boolean},customSearch:{default:()=>({})}},emits:["update:page","update:sortOrder","update:customSearch","more"],setup(M,{emit:a}){b();const s=M,y=a,_=m(s.page),c=m(s.sortOrder),n=m({...s.customSearch}),g=m([...s.programs]),i=m(s.total);v(()=>s.page,e=>{_.value=e}),v(()=>s.sortOrder,e=>{c.value=e}),v(()=>s.programs,e=>{g.value=[...e]}),v(()=>s.total,e=>{i.value=e}),v(()=>s.customSearch,e=>{n.value={...e}},{deep:!0});const h=e=>{g.value=g.value.filter(o=>o.id!==e),i.value--},B=e=>{y("update:customSearch",n.value)};return(e,o)=>{const t=F("Icon");return l(),u("div",{class:k(["recorded-program-list",{"recorded-program-list--show-sort":!e.hideSort}])},[e.hideHeader?f("",!0):(l(),u("div",Z,[d("h2",x,[e.showBackButton?H((l(),u("div",{key:0,class:"recorded-program-list__title-back",onClick:o[0]||(o[0]=r=>e.$router.back())},[p(t,{icon:"fluent:chevron-left-12-filled",width:"27px"})])),[[R]]):f("",!0),d("span",Q,V(e.title),1),e.showMoreButton?f("",!0):(l(),u("div",ee,[e.isSearching?(l(),u(S,{key:0},[p(t,{icon:"line-md:loading-twotone-loop",class:"mr-1 spin",width:"20px",height:"20px"}),o[7]||(o[7]=d("span",null,"検索中...",-1))],64)):(l(),u(S,{key:1},[L(V(i.value)+"件",1)],64))]))]),d("div",{class:k(["recorded-program-list__actions",{"recorded-program-list__actions--mylist":e.forMylist}])},[e.hideSort?f("",!0):(l(),w(K,{key:0,modelValue:c.value,"onUpdate:modelValue":[o[1]||(o[1]=r=>c.value=r),o[2]||(o[2]=r=>e.$emit("update:sortOrder",r))],items:e.forMylist?[{title:"追加が新しい順",value:"mylist_added_desc"},{title:"追加が古い順",value:"mylist_added_asc"},{title:"録画が新しい順",value:"recorded_desc"},{title:"録画が古い順",value:"recorded_asc"}]:[{title:"新しい順",value:"desc"},{title:"古い順",value:"asc"}],"item-title":"title","item-value":"value",class:"recorded-program-list__sort",color:"primary","bg-color":"background-lighten-1",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue","items"])),e.showMoreButton?(l(),w(U,{key:1,variant:"text",class:"recorded-program-list__more",onClick:o[3]||(o[3]=r=>e.$emit("more"))},{default:j(()=>[o[8]||(o[8]=d("span",{class:"text-primary"},"もっと見る",-1)),p(t,{icon:"fluent:chevron-right-12-regular",width:"18px",class:"ml-1 text-text-darken-1",style:{margin:"0px -4px"}})]),_:1,__:[8]})):f("",!0)],2)])),e.showCustomChoice?(l(),u("div",te,[p(G,{customSearch:n.value,"onUpdate:customSearch":o[4]||(o[4]=r=>n.value=r),onChange:B},null,8,["customSearch"])])):f("",!0),d("div",{class:k(["recorded-program-list__grid",{"recorded-program-list__grid--loading":e.isLoading||e.isSearching,"recorded-program-list__grid--empty":i.value===0&&e.showEmptyMessage,"recorded-program-list__grid--searching":e.isSearching}])},[d("div",{class:k(["recorded-program-list__empty",{"recorded-program-list__empty--show":i.value===0&&e.showEmptyMessage&&!e.isSearching}])},[d("div",re,[p(t,{class:"recorded-program-list__empty-icon",icon:e.emptyIcon,width:"54px",height:"54px"},null,8,["icon"]),d("h2",{innerHTML:e.emptyMessage},null,8,oe),e.emptySubMessage?(l(),u("div",{key:0,class:"recorded-program-list__empty-submessage",innerHTML:e.emptySubMessage},null,8,ae)):f("",!0)])],2),d("div",se,[(l(!0),u(S,null,$(g.value,r=>(l(),w(J,{key:r.id,program:r,forMylist:e.forMylist,forWatchedHistory:e.forWatchedHistory,onDeleted:h},null,8,["program","forMylist","forWatchedHistory"]))),128))])],2),!e.hidePagination&&i.value>0?(l(),u("div",le,[p(X,{modelValue:_.value,"onUpdate:modelValue":[o[5]||(o[5]=r=>_.value=r),o[6]||(o[6]=r=>e.$emit("update:page",r))],"active-color":"primary",density:"comfortable",length:Math.ceil(i.value/30),"total-visible":O(I).isSmartphoneVertical()?5:7},null,8,["modelValue","length","total-visible"])])):f("",!0)],2)}}}),de=q(ie,[["__scopeId","data-v-bdef4fe6"]]),ne={class:"route-container"},ue={class:"recorded-programs-container-wrapper"},me={class:"recorded-programs-container"},pe=C({__name:"ForkProgramsView",setup(M){const a=T(),s=b(),y=m([]),_=m(0),c=m(!0),n=m(1),g=m("desc"),i=m({}),h=async()=>{const t=await Y.fetchVideos(g.value,n.value,null,i.value);t&&(y.value=t.recorded_programs,_.value=t.total),c.value=!1},B=async t=>{n.value=t,c.value=!0,await s.replace({query:{...a.query,page:t.toString()}})},e=async t=>{g.value=t,n.value=1,c.value=!0,await s.replace({query:{...a.query,order:t,page:"1"}})},o=async t=>{i.value=t,n.value=1,c.value=!0;const r={...a.query,page:"1"};t.major_genres?r.major_genres=t.major_genres:delete r.major_genres,t.from_date?r.from_date=t.from_date:delete r.from_date,t.to_date?r.to_date=t.to_date:delete r.to_date,await s.replace({query:r})};return v(()=>a.query,async t=>{t.page&&(n.value=parseInt(t.page)),t.order&&(g.value=t.order);const r={};t.major_genres&&(r.major_genres=t.major_genres),t.from_date&&(r.from_date=t.from_date),t.to_date&&(r.to_date=t.to_date),i.value=r,await h()},{deep:!0}),E(async()=>{await N().fetchUser(),a.query.page&&(n.value=parseInt(a.query.page)),a.query.order&&(g.value=a.query.order);const r={};a.query.major_genres&&(r.major_genres=a.query.major_genres),a.query.from_date&&(r.from_date=a.query.from_date),a.query.to_date&&(r.to_date=a.query.to_date),i.value=r,await h()}),(t,r)=>(l(),u("div",ne,[p(W),d("main",null,[p(z),d("div",ue,[p(A),d("div",me,[p(D,{crumbs:[{name:"ホーム",path:"/"},{name:"ビデオをみる",path:"/videos/"},{name:"録画番組一覧（Fork版）",path:"/fork/videos/programs",disabled:!0}]}),p(de,{title:"録画番組一覧（Fork版）",programs:y.value,total:_.value,page:n.value,sortOrder:g.value,isLoading:c.value,showBackButton:!0,showEmptyMessage:!c.value,showCustomChoice:!0,customSearch:i.value,"onUpdate:page":B,"onUpdate:sortOrder":r[0]||(r[0]=P=>e(P)),"onUpdate:customSearch":o},null,8,["programs","total","page","sortOrder","isLoading","showEmptyMessage","customSearch"])])])])]))}}),He=q(pe,[["__scopeId","data-v-7447b968"]]);export{He as default};
