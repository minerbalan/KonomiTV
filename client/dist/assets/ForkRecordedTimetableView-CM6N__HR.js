import{d as X,c as d,b as i,F as x,g as N,n as oe,a as p,t as _,B as s,I as Q,o as l,_ as K,D as re,E as I,q as w,G as ke,x as ne,e as T,f as q,V as Z,h as O,l as Y,z as he,k as $e,H as Te,A as ye,y as De,C as we}from"./index-DeuHV4uV.js";import{B as Se}from"./Breadcrumbs-etRq1boW.js";import{H as Ce,N as Pe,S as Re}from"./SPHeaderBar-CXBPSjNV.js";import{V as Me}from"./VDialog-K6lQZcq4.js";import{V as Ee,a as He,b as Ie,c as Le}from"./VCard-CjJaWFKo.js";import{V as Ve}from"./VDatePicker-Qv7QIRoR.js";import{V as Oe}from"./ssrBoot-saFcwPkN.js";import{F as Fe}from"./ForkVideos-CuMyRk7F.js";import"./dialog-transition-DYgjSI4S.js";import"./index-DNCDB5gt.js";import"./VAvatar-CZ-EvYfu.js";import"./Videos-DzkqMysS.js";const xe={class:"fork-recorded-timetable__date-section"},Be={class:"fork-recorded-timetable__tab-container"},Ne=["onClick"],Ge={class:"fork-recorded-timetable__tab-day"},Ae={class:"fork-recorded-timetable__tab-date"},ze={class:"fork-recorded-timetable__tab-calendar-content"},Ue={class:"fork-recorded-timetable__tab-calendar-text"},We={class:"fork-recorded-timetable__tab-day"},je={class:"fork-recorded-timetable__tab-date"},Je=X({__name:"ForkRecordedTimetableDateTabs",props:{weekTabs:{},isOutsideWeekRange:{type:Boolean},calendarTabContent:{}},emits:["tabClick","showCalendar"],setup(t){return(r,e)=>(l(),d("div",xe,[i("div",Be,[(l(!0),d(x,null,N(r.weekTabs,o=>(l(),d("div",{key:o.date.toDateString(),class:oe(["fork-recorded-timetable__tab",{"fork-recorded-timetable__tab--selected":o.isSelected,"fork-recorded-timetable__tab--today":o.isToday}]),onClick:n=>r.$emit("tabClick",o)},[i("div",Ge,_(o.dayOfWeek),1),i("div",Ae,_(o.label),1)],10,Ne))),128)),i("div",{class:oe(["fork-recorded-timetable__tab fork-recorded-timetable__tab--calendar",{"fork-recorded-timetable__tab--selected":r.isOutsideWeekRange}]),onClick:e[0]||(e[0]=o=>r.$emit("showCalendar"))},[i("div",ze,[i("div",Ue,[i("div",We,_(r.calendarTabContent.day),1),i("div",je,_(r.calendarTabContent.date),1)]),p(s(Q),{icon:"fluent:calendar-ltr-20-regular",class:"fork-recorded-timetable__tab-calendar-icon"})])],2)])]))}}),qe=K(Je,[["__scopeId","data-v-1ee51310"]]),W=3.5,be=W*60,te=4,_e=24,Ye=25,Xe=be,ie=60,Ke=60,Qe=(t,r)=>({setInitialScrollPosition:async()=>{if(await re(),!t.value)return;const n=new Date,u=new Date(r.value);u.setHours(te,0,0,0);const f=Math.floor((n.getTime()-u.getTime())/(1e3*60));if(f>=0&&f<=1440){const v=f*W,g=(t.value.clientHeight-ie)/2,a=Math.max(0,v-g);t.value.scrollTop=a}else{const v=120*W,g=(t.value.clientHeight-ie)/2,a=Math.max(0,v-g);t.value.scrollTop=a}},scrollToTimePeriod:n=>{if(!t.value)return;const u=n*be;t.value.scrollTo({top:u,behavior:"smooth"})}}),Ze=t=>{const r=I(()=>{const o=[],n=new Date(t.value);n.setHours(te,0,0,0);for(let u=0;u<_e;u++){const f=new Date(n.getTime()+u*60*60*1e3),v=f.toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"}),y=f.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",hour12:!1});o.push({label:`${v} ${y}`,date:v,time:y})}return o}),e=I(()=>_e*60*W);return{timeHours:r,timetableHeight:e}},et=t=>{const r=w(!1),e=w(null),o=w({});let n=null,u=null;return{tooltipVisible:r,tooltipProgram:e,tooltipStyle:o,showTooltip:(a,L)=>{var G;n!==null&&(clearTimeout(n),n=null),u!==null&&(clearTimeout(u),u=null);const C=L.currentTarget.getBoundingClientRect();if(!((G=t.value)==null?void 0:G.getBoundingClientRect()))return;const V=window.innerWidth/2,m=C.left<V,R=350,j=8;let H,D;m?H=C.right+j:H=C.left-R-j,D=C.top,H+R>window.innerWidth&&(H=window.innerWidth-R-16),H<16&&(H=16),D+200>window.innerHeight&&(D=window.innerHeight-200-16),D<16&&(D=16),u=window.setTimeout(()=>{e.value=a,r.value=!0,o.value={left:`${H}px`,top:`${D}px`}},300)},hideTooltip:()=>{u!==null&&(clearTimeout(u),u=null),n=window.setTimeout(()=>{r.value=!1,e.value=null},200)},onTooltipMouseEnter:()=>{n!==null&&(clearTimeout(n),n=null)},onTooltipMouseLeave:()=>{r.value=!1,e.value=null}}},ve=t=>{const r=t.getMonth()+1,e=t.getDate();return`${r}/${e}`},fe=t=>t.toLocaleDateString("ja-JP",{year:"numeric",month:"numeric",day:"numeric"}),ge=t=>t.toLocaleDateString("ja-JP",{weekday:"short"}),tt=t=>{if(t instanceof Date){const r=t.getFullYear(),e=t.getMonth(),o=t.getDate();return new Date(r,e,o)}else if(typeof t=="string"){const[r,e,o]=t.split("-").map(Number);return new Date(r,e-1,o)}else return new Date},ot=t=>t>=4?t-4:20+t,rt=t=>new Date(t).getMinutes().toString().padStart(2,"0"),it=(t,r)=>{if(!t||!r)return"";const e=new Date(t),o=new Date(e.getTime()+r*1e3),n=u=>u.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${n(e)} ã€œ ${n(o)}`},nt=t=>{const r=Math.floor(t/3600),e=Math.floor(t%3600/60),o=Math.floor(t%60);return`${r}:${e.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`},st=t=>t>=1024*1024*1024?`${(t/(1024*1024*1024)).toFixed(2)} GB`:t>=1024*1024?`${(t/(1024*1024)).toFixed(2)} MB`:`${(t/1024).toFixed(2)} KB`;function at(t,r){if(!t||!r||r===0)return 0;const e=r/60;return Math.round(t/e*10)/10}function lt(t){return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}k`:t.toLocaleString()}const dt={"ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»å ±é“":{r:59,g:130,b:246},ã‚¹ãƒãƒ¼ãƒ„:{r:34,g:197,b:94},"æƒ…å ±ãƒ»ãƒ¯ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼":{r:249,g:115,b:22},ãƒ‰ãƒ©ãƒ:{r:236,g:72,b:153},éŸ³æ¥½:{r:168,g:85,b:247},ãƒãƒ©ã‚¨ãƒ†ã‚£:{r:234,g:179,b:8},æ˜ ç”»:{r:239,g:68,b:68},"ã‚¢ãƒ‹ãƒ¡ãƒ»ç‰¹æ’®":{r:6,g:182,b:212},"ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ã‚¿ãƒªãƒ¼ãƒ»æ•™é¤Š":{r:161,g:98,b:7},"åŠ‡å ´ãƒ»å…¬æ¼”":{r:147,g:51,b:234},"è¶£å‘³ãƒ»æ•™è‚²":{r:20,g:184,b:166},ç¦ç¥‰:{r:132,g:204,b:22},ãã®ä»–:{r:107,g:114,b:128}},S={NORMAL:.08,SINGLE:.12,HOVER:.14,SINGLE_HOVER:.18,STRIPE:1},se=(t,r=3)=>!t||t.length===0?[]:t.slice(0,r).map(e=>dt[e.major]).filter(e=>e!==void 0),ct=t=>{const r=se(t);if(r.length===0)return null;const e=r.map(o=>`rgba(${o.r}, ${o.g}, ${o.b}, ${S.STRIPE})`);return e.length===1?e[0]:e.length===2?`linear-gradient(to bottom, ${e[0]} 0%, ${e[0]} 50%, ${e[1]} 50%, ${e[1]} 100%)`:`linear-gradient(to bottom, ${e[0]} 0%, ${e[0]} 33.33%, ${e[1]} 33.33%, ${e[1]} 66.66%, ${e[2]} 66.66%, ${e[2]} 100%)`},ut=t=>{const r=se(t),e="rgb(var(--v-theme-surface))";if(r.length===0)return e;if(r.length===1){const o=r[0];return`linear-gradient(rgba(${o.r}, ${o.g}, ${o.b}, ${S.SINGLE}), rgba(${o.r}, ${o.g}, ${o.b}, ${S.SINGLE})), ${e}`}else if(r.length===2){const o=r[0],n=r[1];return`linear-gradient(135deg, rgba(${o.r}, ${o.g}, ${o.b}, ${S.NORMAL}) 0%, rgba(${n.r}, ${n.g}, ${n.b}, ${S.NORMAL}) 100%), ${e}`}else{const o=r[0],n=r[1];return`linear-gradient(135deg, rgba(${o.r}, ${o.g}, ${o.b}, ${S.NORMAL}) 0%, rgba(${n.r}, ${n.g}, ${n.b}, ${S.NORMAL}) 100%), ${e}`}},mt=t=>{const r=se(t),e="rgb(var(--v-theme-surface))";if(r.length===0)return"rgb(var(--v-theme-primary-lighten-4))";if(r.length===1){const o=r[0];return`linear-gradient(rgba(${o.r}, ${o.g}, ${o.b}, ${S.SINGLE_HOVER}), rgba(${o.r}, ${o.g}, ${o.b}, ${S.SINGLE_HOVER})), ${e}`}else if(r.length===2){const o=r[0],n=r[1];return`linear-gradient(135deg, rgba(${o.r}, ${o.g}, ${o.b}, ${S.HOVER}) 0%, rgba(${n.r}, ${n.g}, ${n.b}, ${S.HOVER}) 100%), ${e}`}else{const o=r[0],n=r[1];return`linear-gradient(135deg, rgba(${o.r}, ${o.g}, ${o.b}, ${S.HOVER}) 0%, rgba(${n.r}, ${n.g}, ${n.b}, ${S.HOVER}) 100%), ${e}`}},_t=(t,r,e)=>{const o=new Date(t.start_time),n=new Date(e);n.setHours(te,0,0,0);const u=Math.floor((o.getTime()-n.getTime())/(1e3*60)),f=t.duration/60,v=u*W,y=Math.max(f*W,Ye),g=ut(t.genres),a=ct(t.genres),L=mt(t.genres),E={position:"absolute",top:`${v}px`,height:`${y}px`,width:"100%",left:"0",zIndex:String(r)};return g&&(E.background=g),a&&(E["--genre-stripe"]=a),L&&(E["--genre-bg-hover"]=L),E},ft=(t,r)=>{const e=new Date(r);e.setHours(te,0,0,0);const o=Math.floor((t.getTime()-e.getTime())/(1e3*60));return o<0||o>24*60?null:o*W},gt={class:"fork-recorded-timetable__grid"},bt={class:"fork-recorded-timetable__time-column"},vt={class:"fork-recorded-timetable__time-date"},pt={class:"fork-recorded-timetable__time-hour"},kt=["onClick","onMouseenter"],ht={class:"fork-recorded-timetable__program-content"},$t={class:"fork-recorded-timetable__program-left"},Tt={class:"fork-recorded-timetable__program-minutes"},yt={key:0,class:"fork-recorded-timetable__program-comments"},Dt={class:"fork-recorded-timetable__program-comments-value"},wt={class:"fork-recorded-timetable__program-info"},St={class:"fork-recorded-timetable__program-title"},Ct={key:0,class:"fork-recorded-timetable__program-subtitle"},Pt={key:1,class:"fork-recorded-timetable__program-description"},Rt={class:"fork-recorded-timetable__tooltip-time"},Mt={key:0,class:"fork-recorded-timetable__tooltip-comment-compact"},Et={class:"fork-recorded-timetable__tooltip-comment-badge"},Ht={class:"fork-recorded-timetable__tooltip-comment-total"},It={class:"fork-recorded-timetable__tooltip-comment-rate"},Lt={class:"fork-recorded-timetable__tooltip-comment-rate-value"},Vt={class:"fork-recorded-timetable__tooltip-title"},Ot={key:1,class:"fork-recorded-timetable__tooltip-subtitle"},Ft={key:2,class:"fork-recorded-timetable__tooltip-description"},xt={key:3,class:"fork-recorded-timetable__tooltip-genres"},Bt={class:"fork-recorded-timetable__tooltip-genre-list"},Nt={key:4,class:"fork-recorded-timetable__tooltip-video-info"},Gt={class:"fork-recorded-timetable__tooltip-info-grid"},At={key:0},zt={class:"fork-recorded-timetable__tooltip-info-value"},Ut={key:1},Wt={class:"fork-recorded-timetable__tooltip-info-value"},jt={key:2},Jt={class:"fork-recorded-timetable__tooltip-info-value"},qt={key:3},Yt={class:"fork-recorded-timetable__tooltip-info-value"},Xt={key:5,class:"fork-recorded-timetable__tooltip-detail"},Kt={key:0,class:"fork-recorded-timetable__tooltip-detail-section"},Qt={class:"fork-recorded-timetable__tooltip-label"},Zt={class:"fork-recorded-timetable__tooltip-detail-content"},eo=X({__name:"ForkRecordedTimetableGrid",props:{programs:{},channels:{},displayDate:{},currentTime:{}},emits:["programClick"],setup(t,{expose:r}){const e=t,o=w(null),n=ke(e,"displayDate"),{timeHours:u,timetableHeight:f}=Ze(n),{setInitialScrollPosition:v,scrollToTimePeriod:y}=Qe(o,n),{tooltipVisible:g,tooltipProgram:a,tooltipStyle:L,showTooltip:E,hideTooltip:C,onTooltipMouseEnter:P,onTooltipMouseLeave:V}=et(o),m=I(()=>{const $=e.channels.length;return`${Ke}px repeat(${$}, minmax(150px, 200px))`}),R=$=>e.programs.filter(c=>c.channel_id===$).sort((c,F)=>new Date(c.start_time).getTime()-new Date(F.start_time).getTime()),j=($,c)=>_t($,c,e.displayDate),H=()=>{const $=ft(e.currentTime,e.displayDate);return $===null?{display:"none"}:{position:"absolute",top:`${$}px`,left:"0",right:"0",height:"2px",background:"#ff4444",zIndex:20,gridColumn:"1 / -1",gridRow:2,pointerEvents:"none"}},D=$=>{var A,z,U;const c=(z=(A=$.recorded_video)==null?void 0:A.fork_recorded_video)==null?void 0:z.comment_count,F=(U=$.recorded_video)==null?void 0:U.duration;return!c||!F?0:at(c,F)},G=$=>lt($);return r({scrollToTimePeriod:y,setInitialScrollPosition:v}),ne(()=>{v()}),($,c)=>{var F,A,z,U,k,b,B,ae,le,de,ce,ue,me;return l(),d("div",gt,[i("div",{class:"fork-recorded-timetable__body",ref_key:"scrollContainer",ref:o},[i("div",{class:"fork-recorded-timetable__grid-container",style:q({gridTemplateColumns:m.value,height:`${s(f)+s(ie)}px`})},[c[5]||(c[5]=i("div",{class:"fork-recorded-timetable__time-column-header"},"æ™‚é–“",-1)),(l(!0),d(x,null,N($.channels,h=>(l(),d("div",{key:h.id,class:"fork-recorded-timetable__channel-header"},_(h.name),1))),128)),i("div",bt,[(l(!0),d(x,null,N(s(u),h=>(l(),d("div",{key:h.label,class:"fork-recorded-timetable__time-label",style:q({height:`${s(Xe)}px`})},[i("div",vt,_(h.date),1),i("div",pt,_(h.time),1)],4))),128))]),(l(!0),d(x,null,N($.channels,(h,J)=>(l(),d("div",{key:h.id,class:"fork-recorded-timetable__channel-column",style:q({gridColumn:J+2,gridRowStart:2})},[(l(!0),d(x,null,N(R(h.id),(M,pe)=>(l(),d("div",{key:M.id,class:"fork-recorded-timetable__program-item",style:q(j(M,pe)),onClick:ee=>$.$emit("programClick",M),onMouseenter:ee=>s(E)(M,ee),onMouseleave:c[0]||(c[0]=(...ee)=>s(C)&&s(C)(...ee))},[i("div",ht,[i("div",$t,[i("div",Tt,_(s(rt)(M.start_time)),1),D(M)>0?(l(),d("div",yt,[c[3]||(c[3]=i("div",{class:"fork-recorded-timetable__program-comments-icon"},"âš¡",-1)),i("div",Dt,_(D(M)),1),c[4]||(c[4]=i("div",{class:"fork-recorded-timetable__program-comments-unit"},"/åˆ†",-1))])):T("",!0)]),i("div",wt,[i("div",St,_(M.title),1),M.subtitle?(l(),d("div",Ct,_(M.subtitle),1)):T("",!0),M.description?(l(),d("div",Pt,_(M.description),1)):T("",!0)])])],44,kt))),128))],4))),128)),i("div",{class:"fork-recorded-timetable__current-time-line",style:q(H())},null,4)],4)],512),s(g)?(l(),d("div",{key:0,class:"fork-recorded-timetable__tooltip",style:q(s(L)),onMouseenter:c[1]||(c[1]=(...h)=>s(P)&&s(P)(...h)),onMouseleave:c[2]||(c[2]=(...h)=>s(V)&&s(V)(...h))},[i("div",Rt,_(s(it)((F=s(a))==null?void 0:F.start_time,(A=s(a))==null?void 0:A.duration)),1),(k=(U=(z=s(a))==null?void 0:z.recorded_video)==null?void 0:U.fork_recorded_video)!=null&&k.comment_count?(l(),d("div",Mt,[i("div",Et,[c[6]||(c[6]=i("span",{class:"fork-recorded-timetable__tooltip-comment-icon"},"ğŸ’¬",-1)),i("span",Ht,_(G(s(a).recorded_video.fork_recorded_video.comment_count))+"ä»¶ ",1)]),i("div",It,[c[7]||(c[7]=i("span",{class:"fork-recorded-timetable__tooltip-comment-rate-icon"},"âš¡",-1)),i("span",Lt,_(D(s(a)))+"/åˆ† ",1)])])):T("",!0),i("div",Vt,_((b=s(a))==null?void 0:b.title),1),(B=s(a))!=null&&B.subtitle?(l(),d("div",Ot,_((ae=s(a))==null?void 0:ae.subtitle),1)):T("",!0),(le=s(a))!=null&&le.description?(l(),d("div",Ft,_((de=s(a))==null?void 0:de.description),1)):T("",!0),(ce=s(a))!=null&&ce.genres&&s(a).genres.length>0?(l(),d("div",xt,[c[8]||(c[8]=i("div",{class:"fork-recorded-timetable__tooltip-label"},"ã‚¸ãƒ£ãƒ³ãƒ«",-1)),i("div",Bt,[(l(!0),d(x,null,N(s(a).genres,(h,J)=>(l(),d("span",{key:J,class:"fork-recorded-timetable__tooltip-genre-tag"},_(h.major)+_(h.middle?` / ${h.middle}`:""),1))),128))])])):T("",!0),(ue=s(a))!=null&&ue.recorded_video?(l(),d("div",Nt,[c[13]||(c[13]=i("div",{class:"fork-recorded-timetable__tooltip-label"},"éŒ²ç”»æƒ…å ±",-1)),i("div",Gt,[s(a).recorded_video.video_resolution_width&&s(a).recorded_video.video_resolution_height?(l(),d("div",At,[c[9]||(c[9]=i("span",{class:"fork-recorded-timetable__tooltip-info-key"},"è§£åƒåº¦:",-1)),i("span",zt,_(s(a).recorded_video.video_resolution_width)+"Ã—"+_(s(a).recorded_video.video_resolution_height),1)])):T("",!0),s(a).recorded_video.video_codec?(l(),d("div",Ut,[c[10]||(c[10]=i("span",{class:"fork-recorded-timetable__tooltip-info-key"},"æ˜ åƒ:",-1)),i("span",Wt,_(s(a).recorded_video.video_codec),1)])):T("",!0),s(a).recorded_video.duration?(l(),d("div",jt,[c[11]||(c[11]=i("span",{class:"fork-recorded-timetable__tooltip-info-key"},"å®ŸéŒ²ç”»æ™‚é–“:",-1)),i("span",Jt,_(s(nt)(s(a).recorded_video.duration)),1)])):T("",!0),s(a).recorded_video.file_size?(l(),d("div",qt,[c[12]||(c[12]=i("span",{class:"fork-recorded-timetable__tooltip-info-key"},"ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º:",-1)),i("span",Yt,_(s(st)(s(a).recorded_video.file_size)),1)])):T("",!0)])])):T("",!0),(me=s(a))!=null&&me.detail?(l(),d("div",Xt,[(l(!0),d(x,null,N(s(a).detail,(h,J)=>(l(),d(x,{key:J},[h?(l(),d("div",Kt,[i("div",Qt,_(J),1),i("div",Zt,_(h),1)])):T("",!0)],64))),128))])):T("",!0)],36)):T("",!0)])}}}),to=K(eo,[["__scopeId","data-v-d2736563"]]),oo={class:"fork-recorded-timetable__header"},ro={class:"fork-recorded-timetable__title"},io={class:"fork-recorded-timetable__title-text"},no={key:0,class:"fork-recorded-timetable__title-loading"},so={key:1,class:"fork-recorded-timetable__title-count"},ao={class:"fork-recorded-timetable__controls"},lo={class:"fork-recorded-timetable__date-display ml-4"},co=X({__name:"ForkRecordedTimetableHeader",props:{title:{},isLoading:{type:Boolean},totalPrograms:{},currentDateLabel:{}},emits:["previousDay","today","nextDay"],setup(t){return(r,e)=>(l(),d("div",oo,[i("div",ro,[i("span",io,_(r.title),1),r.isLoading?(l(),d("span",no,[p(s(Q),{icon:"line-md:loading-twotone-loop",class:"mr-1 spin",width:"20px",height:"20px"}),e[3]||(e[3]=i("span",null,"èª­ã¿è¾¼ã¿ä¸­...",-1))])):T("",!0),r.isLoading?T("",!0):(l(),d("span",so,_(r.totalPrograms)+"ä»¶ã®éŒ²ç”»ç•ªçµ„ ",1))]),i("div",ao,[p(Z,{variant:"outlined",size:"small",onClick:e[0]||(e[0]=o=>r.$emit("previousDay")),class:"mr-2"},{default:O(()=>[p(s(Q),{icon:"fluent:chevron-left-20-regular",width:"18px"}),e[4]||(e[4]=Y(" å‰æ—¥ ",-1))]),_:1,__:[4]}),p(Z,{variant:"outlined",color:"primary",onClick:e[1]||(e[1]=o=>r.$emit("today")),class:"mr-2"},{default:O(()=>[p(s(Q),{icon:"fluent:calendar-ltr-20-regular",width:"18px",class:"mr-1"}),e[5]||(e[5]=Y(" ä»Šæ—¥ ",-1))]),_:1,__:[5]}),p(Z,{variant:"outlined",size:"small",onClick:e[2]||(e[2]=o=>r.$emit("nextDay"))},{default:O(()=>[e[6]||(e[6]=Y(" ç¿Œæ—¥ ",-1)),p(s(Q),{icon:"fluent:chevron-right-20-regular",width:"18px",class:"ml-1"})]),_:1,__:[6]}),i("div",lo,_(r.currentDateLabel),1)])]))}}),uo=K(co,[["__scopeId","data-v-ed3cc0c7"]]),mo={class:"fork-recorded-timetable__time-section"},_o={class:"fork-recorded-timetable__time-buttons"},fo=["onClick"],go={class:"fork-recorded-timetable__time-button-label"},bo={class:"fork-recorded-timetable__time-button-time"},vo=X({__name:"ForkRecordedTimetableTimePeriods",props:{timePeriods:{},selectedTimePeriod:{}},emits:["scrollToPeriod"],setup(t){return(r,e)=>(l(),d("div",mo,[i("div",_o,[(l(!0),d(x,null,N(r.timePeriods,o=>(l(),d("button",{key:o.key,class:oe(["fork-recorded-timetable__time-button",{"fork-recorded-timetable__time-button--selected":r.selectedTimePeriod===o.key}]),onClick:n=>r.$emit("scrollToPeriod",o)},[i("span",go,_(o.label),1),i("span",bo,_(o.startTime),1)],10,fo))),128))])]))}}),po=K(vo,[["__scopeId","data-v-1a487513"]]),ko=(t,r,e)=>r?"ä»Šæ—¥":e===1?"æ˜¨æ—¥":ve(t),ho=t=>{const r=I(()=>{const n=[],u=new Date;for(let f=0;f>=-6;f--){const v=new Date(u);v.setDate(u.getDate()+f);const y=f===0,g=v.toDateString()===t.value.toDateString();n.push({date:new Date(v),label:ko(v,y,Math.abs(f)),isToday:y,isSelected:g,dayOfWeek:ge(v),daysAgo:Math.abs(f)})}return n}),e=I(()=>{const n=new Date,u=t.value.toDateString();for(let f=0;f>=-6;f--){const v=new Date(n);if(v.setDate(n.getDate()+f),v.toDateString()===u)return!1}return!0}),o=I(()=>e.value?{day:ge(t.value),date:ve(t.value)}:{day:"æ—¥ä»˜",date:"é¸æŠ"});return{weekTabs:r,isOutsideWeekRange:e,calendarTabContent:o}},$o=[{key:"morning",label:"æœ",startTime:"04:00",hour:4},{key:"noon",label:"æ˜¼",startTime:"10:00",hour:10},{key:"evening",label:"å¤•",startTime:"16:00",hour:16},{key:"midnight",label:"æ·±å¤œ",startTime:"21:00",hour:21}],To={class:"fork-recorded-timetable"},yo={class:"fork-recorded-timetable__navigation"},Do={class:"fork-recorded-timetable__content"},wo={key:1,class:"fork-recorded-timetable__loading"},So=X({__name:"ForkRecordedTimetable",props:{title:{},programs:{default:()=>[]},channels:{default:()=>[]},isLoading:{type:Boolean,default:!1},initialDate:{}},emits:["programClick","fetchProgramData"],setup(t,{emit:r}){const e=t,o=r,n=w(new Date),u=w(!1),f=w(new Date().toISOString().substring(0,10)),v=w(""),y=w(new Date),g=w(null);let a=null;const{weekTabs:L,isOutsideWeekRange:E,calendarTabContent:C}=ho(n),P=$o,V=I(()=>e.channels||[]),m=I(()=>e.programs||[]),R=I(()=>{const k=n.value,b=new Date(k);return b.setDate(k.getDate()+1),`${fe(k)} 4:00 ã€œ ${fe(b)} 4:00`}),j=I(()=>m.value.length),H=k=>{o("programClick",k)},D=k=>{n.value=new Date(k),o("fetchProgramData",k)},G=k=>{const b=new Date(n.value);b.setDate(b.getDate()+k),D(b)},$=()=>{G(-1)},c=()=>{G(1)},F=()=>{D(new Date)},A=k=>{D(k.date)},z=()=>{const k=tt(f.value);u.value=!1,D(k)},U=async k=>{if(v.value=k.key,await re(),!g.value)return;const b=ot(k.hour);g.value.scrollToTimePeriod(b)};return ne(async()=>{n.value=e.initialDate||new Date,o("fetchProgramData",n.value),y.value=new Date,a=window.setInterval(()=>{y.value=new Date},6e4),await re(),setTimeout(()=>{g.value&&g.value.setInitialScrollPosition()},100)}),he(()=>{a&&(clearInterval(a),a=null)}),(k,b)=>(l(),d("div",To,[p(uo,{title:k.title,"is-loading":k.isLoading,"total-programs":j.value,"current-date-label":R.value,onPreviousDay:$,onToday:F,onNextDay:c},null,8,["title","is-loading","total-programs","current-date-label"]),i("div",yo,[p(qe,{"week-tabs":s(L),"is-outside-week-range":s(E),"calendar-tab-content":s(C),onTabClick:A,onShowCalendar:b[0]||(b[0]=B=>u.value=!0)},null,8,["week-tabs","is-outside-week-range","calendar-tab-content"]),p(po,{"time-periods":s(P),"selected-time-period":v.value,onScrollToPeriod:U},null,8,["time-periods","selected-time-period"])]),i("div",Do,[k.isLoading?T("",!0):(l(),$e(to,{key:0,ref_key:"gridRef",ref:g,programs:m.value,channels:V.value,"display-date":n.value,"current-time":y.value,onProgramClick:H},null,8,["programs","channels","display-date","current-time"])),k.isLoading?(l(),d("div",wo,[p(Te,{indeterminate:"",color:"primary",size:"48"}),b[4]||(b[4]=i("p",{class:"mt-4"},"ç•ªçµ„è¡¨ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...",-1))])):T("",!0)]),p(Me,{modelValue:u.value,"onUpdate:modelValue":b[3]||(b[3]=B=>u.value=B),"max-width":"400px"},{default:O(()=>[p(Ee,null,{default:O(()=>[p(He,null,{default:O(()=>b[5]||(b[5]=[Y("æ—¥ä»˜ã‚’é¸æŠ",-1)])),_:1,__:[5]}),p(Ie,null,{default:O(()=>[p(Ve,{modelValue:f.value,"onUpdate:modelValue":b[1]||(b[1]=B=>f.value=B),max:new Date().toISOString().substring(0,10),"show-adjacent-months":""},null,8,["modelValue","max"])]),_:1}),p(Le,null,{default:O(()=>[p(Oe),p(Z,{variant:"text",onClick:b[2]||(b[2]=B=>u.value=!1)},{default:O(()=>b[6]||(b[6]=[Y("ã‚­ãƒ£ãƒ³ã‚»ãƒ«",-1)])),_:1,__:[6]}),p(Z,{color:"primary",onClick:z},{default:O(()=>b[7]||(b[7]=[Y("é¸æŠ",-1)])),_:1,__:[7]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Co=K(So,[["__scopeId","data-v-bbf55d78"]]),Po={class:"route-container"},Ro={class:"recorded-timetable-container-wrapper"},Mo={class:"recorded-timetable-container"},Eo=X({__name:"ForkRecordedTimetableView",setup(t){const r=we(),e=ye(),o=w(!0),n=I(()=>{const g=e.query.date;if(g){const a=new Date(g);if(!isNaN(a.getTime())&&a<=new Date)return a}}),u=w([]),f=w([]),v=g=>{const a=e.query.date;r.push({path:`/videos/watch/${g.id}`,query:{referrer:"fork-timetable",...a&&{timetable_date:a}}})},y=async g=>{o.value=!0;const a=g.getFullYear(),L=String(g.getMonth()+1).padStart(2,"0"),E=String(g.getDate()).padStart(2,"0"),C=`${a}-${L}-${E}`;r.replace({query:{date:C}});try{const P=await Fe.fetchVideoTimetable(C);if(console.log(P),P){u.value=P.recorded_programs.map(m=>{var R;return{id:m.id,title:m.title,subtitle:m.subtitle||void 0,description:m.description||void 0,start_time:m.start_time,duration:m.duration,channel_id:((R=m.channel)==null?void 0:R.id)||"",genres:m.genres,detail:m.detail,recorded_video:m.recorded_video?{file_size:m.recorded_video.file_size,duration:m.recorded_video.duration,video_resolution_width:m.recorded_video.video_resolution_width,video_resolution_height:m.recorded_video.video_resolution_height,video_codec:m.recorded_video.video_codec,fork_recorded_video:m.recorded_video.fork_recorded_video}:void 0}});const V=new Map;P.recorded_programs.forEach(m=>{m.channel&&!V.has(m.channel.id)&&V.set(m.channel.id,m.channel)}),f.value=Array.from(V.values()).sort((m,R)=>m.channel_number.localeCompare(R.channel_number)).map(m=>({id:m.id,name:m.name}))}else u.value=[],f.value=[]}catch(P){console.error("ç•ªçµ„ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:",P),u.value=[],f.value=[]}finally{o.value=!1}};return ne(async()=>{await De().fetchUser(),o.value=!1}),(g,a)=>(l(),d("div",Po,[p(Ce),i("main",null,[p(Pe),i("div",Ro,[p(Re),i("div",Mo,[p(Se,{crumbs:[{name:"ãƒ›ãƒ¼ãƒ ",path:"/"},{name:"ãƒ“ãƒ‡ã‚ªã‚’ã¿ã‚‹",path:"/videos/"},{name:"éŒ²ç”»ç•ªçµ„ç•ªçµ„è¡¨ï¼ˆForkç‰ˆï¼‰",path:"/fork/videos/timetable",disabled:!0}]}),p(Co,{title:"éŒ²ç”»ç•ªçµ„ç•ªçµ„è¡¨ï¼ˆForkç‰ˆï¼‰",programs:u.value,channels:f.value,isLoading:o.value,initialDate:n.value,onFetchProgramData:y,onProgramClick:v},null,8,["programs","channels","isLoading","initialDate"])])])])]))}}),Uo=K(Eo,[["__scopeId","data-v-16adf2b2"]]);export{Uo as default};
